install.packages("nnet")
library("nnet")
training = read.csv("lab5_train.csv")
training$CAND_ID = as.integer(training$CAND_ID == "Romney")
net = nnet(formula = CAND_ID~TRANSACTION_AMT, data = training, size = 10)
testing = read.csv("lab5_test.csv")
predict(net, newdata=training)
hist(predict(net, newdata=training))
(predict(net, newdata=training) > .5)
as.integer(predict(net, newdata=training) > .5)
as.integer(predict(net, newdata=training) > .5) == training$CAND_ID
mean(as.integer(predict(net, newdata=training) > .5) == training$CAND_ID)
mean(as.integer(predict(net, newdata=testing) > .5) == testing$CAND_ID)
testing$CAND_ID == as.integer(testing$CAND_ID == "Romney")
testing$CAND_ID = as.integer(testing$CAND_ID == "Romney")
mean(as.integer(predict(net, newdata=testing) > .5) == testing$CAND_ID)
net = nnet(formula = CAND_ID~TRANSACTION_AMT, data = training, size = 10, abstol = 0.01)
net = nnet(formula = CAND_ID~TRANSACTION_AMT, data = training, size = 10, abstol = 0.01, maxit = 1000)
net = nnet(formula = CAND_ID~TRANSACTION_AMT, data = training, size = 10, abstol = 0.01, maxit = 100)
net = nnet(formula = CAND_ID~TRANSACTION_AMT, data = training, size = 10, abstol = 0.01, maxit = 500)
net = nnet(formula = CAND_ID~TRANSACTION_AMT, data = training, size = 10, abstol = 0.01, maxit = 800)
net = nnet(formula = CAND_ID~TRANSACTION_AMT, data = training, size = 10, abstol = 0.001, maxit = 800)
net = nnet(formula = CAND_ID~TRANSACTION_AMT, data = training, size = 10, maxit = 800)
net = nnet(formula = CAND_ID~TRANSACTION_AMT, data = training, size = 10, maxit = 1000)
net = nnet(formula = CAND_ID~TRANSACTION_AMT, data = training, size = 10, maxit = 10000)
net = nnet(formula = CAND_ID~TRANSACTION_AMT, data = training, size = 10, maxit = 1000)
net = nnet(formula = CAND_ID~TRANSACTION_AMT, data = training, size = 10, maxit = 1000, reltol=0.01)
net = nnet(formula = CAND_ID~TRANSACTION_AMT, data = training, size = 10, maxit = 1000, reltol=0.99)
net = nnet(formula = CAND_ID~TRANSACTION_AMT, data = training, size = 10, maxit = 1000)
net$fitted.values

predict(net, newdata=training)
net = nnet(formula = CAND_ID~TRANSACTION_AMT, data = training, size = 10)
